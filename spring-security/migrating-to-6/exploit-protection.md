5.8移行ガイドには、6.0にアップデートする際のエクスプロイトプロテクションの移行のためのいくつかの手順が記載されています。まずはこれらのステップに従うことが推奨されます。

次のステップは、エクスプロイト保護サポートの移行を完了する方法に関するものです。

# Defer Loading CsrfToken

Spring Security
5.8では、CsrfTokenをアプリケーションで利用可能にするためのCsrfTokenRequestHandlerのデフォルトがCsrfTokenRequestAttributeHandlerです。フィールドcsrfRequestAttributeNameのデフォルトはnullであるため、すべてのリクエストでCSRFトークンがロードされることになります。

Spring Security 6では、csrfRequestAttributeNameのデフォルトが_csrfとなっています。6.0へのアップデートのためだけに下記を設定した場合は、削除できるようになりました：

```java
requestHandler.setCsrfRequestAttributeName("_csrf");
```

# Protect against CSRF BREACH

Spring Security
5.8では、CsrfTokenをアプリケーションで利用可能にするためのデフォルトのCsrfTokenRequestHandlerはCsrfTokenRequestAttributeHandlerでした。CSRFのBREACHサポートにオプトインできるように、XorCsrfTokenRequestAttributeHandlerが追加されました。

Spring Security
6では、CsrfTokenを利用可能にするためのCsrfTokenRequestHandlerとしてXorCsrfTokenRequestAttributeHandlerがデフォルトになっています。6.0へのアップデートのためだけにXorCsrfTokenRequestAttributeHandlerを設定した場合は、完全に削除することができます。

[NOTE]
遅延トークンをオプトアウトするためにcsrfRequestAttributeNameをnullに設定した場合、またはその他の理由でCsrfTokenRequestHandlerを設定した場合は、その設定をそのままにしておいてください。

# CSRF BREACH with WebSocket support

Spring Security 5.8では、WebSocket
SecurityでCsrfTokenを利用可能にするためのデフォルトのChannelInterceptorはCsrfChannelInterceptorでした。CSRFのBREACHサポートにオプトインできるように、XorCsrfChannelInterceptorが追加されました。

Spring Security
6では、CsrfTokenを利用可能にするためのChannelInterceptorとして、XorCsrfChannelInterceptorがデフォルトで使用されています。6.0へのアップデートのためだけにXorCsrfChannelInterceptorを設定したのであれば、完全に削除することができます。
